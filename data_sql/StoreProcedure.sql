-----------------------------------------------------------------------------------------------
--/////////////////////////////////////////////////////////
--USP_L_SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_L_SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_L_SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES
GO

CREATE PROCEDURE [dbo].[USP_L_SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES]
(
	@META_VCH_IDMETA varchar(4),
	@EGAS_VCH_IDESPECIFICADEGASTO varchar(13)
)
AS
/*
+	NOMBRE				: USP_L_SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES
+	DESCRIPCION			: LISTA LAS METAS CON ESPECIFICAS DE GASTOS (PIM CON MODIFICACIONES)
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
SELECT
MEGM_INT_IDMODIFICACION,
META_VCH_IDMETA, 
EGAS_VCH_IDESPECIFICADEGASTO,
MEGM_DEC_PIMMODIFICADO
FROM SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES WHERE
META_VCH_IDMETA=@META_VCH_IDMETA AND
EGAS_VCH_IDESPECIFICADEGASTO=@EGAS_VCH_IDESPECIFICADEGASTO

GO
-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_D_SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES
--/////////////////////////////////////////////////////////
IF OBJECT_ID ( 'USP_D_SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_D_SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES
GO
CREATE PROCEDURE [dbo].[USP_D_SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES]
(
 @MEGM_INT_IDMODIFICACION INT
)
AS
/*
+	NOMBRE				: USP_D_SICOP_ESPECIFICADEGASTO
+	DESCRIPCION			: ELIMINA UNA DETERMINADA MODIFICACION DE UNA DETERMINADA META DE UNA ESPECIFICA DE GASTO
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
DELETE FROM SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES
WHERE MEGM_INT_IDMODIFICACION = @MEGM_INT_IDMODIFICACION
GO

-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_U_SICOP_META_ESPECIFICADEGASTO
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_U_SICOP_META_ESPECIFICADEGASTO', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_U_SICOP_META_ESPECIFICADEGASTO
GO
CREATE PROCEDURE [dbo].[USP_U_SICOP_META_ESPECIFICADEGASTO]
(
	@META_VCH_IDMETA varchar(4),
	@EGAS_VCH_IDESPECIFICADEGASTO varchar(13),
	@MEGA_VCH_ANIO varchar(4),
	@MEGA_DEC_PIM decimal(10,3)
)
AS
/*
+	NOMBRE				: USP_U_SICOP_META_ESPECIFICADEGASTO
+	DESCRIPCION			: MODIFICAR EL PIM DE UNA DETERMINADA META SEGÚN LA ID DE ESPECIFICA DE GASTOY EL ANIO
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
UPDATE SICOP_META_ESPECIFICADEGASTO SET MEGA_DEC_PIM=@MEGA_DEC_PIM 
 
WHERE	META_VCH_IDMETA=@META_VCH_IDMETA AND
		EGAS_VCH_IDESPECIFICADEGASTO= @EGAS_VCH_IDESPECIFICADEGASTO AND
		MEGA_VCH_ANIO= @MEGA_VCH_ANIO
GO
-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_D_SICOP_DETALLECONTROLPRESUPUESTAL
--/////////////////////////////////////////////////////////
IF OBJECT_ID ( 'USP_D_SICOP_DETALLECONTROLPRESUPUESTAL', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_D_SICOP_DETALLECONTROLPRESUPUESTAL
GO
CREATE PROCEDURE [dbo].[USP_D_SICOP_DETALLECONTROLPRESUPUESTAL]
(
	@CPRE_INT_IDCONTROLPRESUPUESTAL INT  
)
AS
/*
+	NOMBRE				: USP_D_SICOP_DETALLECONTROLPRESUPUESTAL
+	DESCRIPCION			: ELIMINA UN DETALLE DE CONTROL PRESUPUESTAL SEGÚN SU ID DE CONTROL PRESUPUESTAL
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
DELETE SICOP_DETALLECONTROLPRESUPUESTAL
WHERE CPRE_INT_IDCONTROLPRESUPUESTAL=@CPRE_INT_IDCONTROLPRESUPUESTAL  

GO
-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_L_SICOP_DETALLECONTROLPRESUPUESTAL
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_L_SICOP_DETALLECONTROLPRESUPUESTAL', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_L_SICOP_DETALLECONTROLPRESUPUESTAL
GO
CREATE PROCEDURE [dbo].[USP_L_SICOP_DETALLECONTROLPRESUPUESTAL]
(
	@CPRE_INT_IDCONTROLPRESUPUESTAL INT 
	 
)
AS
/*
+	NOMBRE				: USP_L_SICOP_DETALLECONTROLPRESUPUESTAL
+	DESCRIPCION			: LISTAR LOS DETALLES DE CONTROL PRESUPUESTAL SEGÚN LA ID DE CONTROL PRESUPUESTAL
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
SELECT 
META_VCH_IDMETA,
DCPR_DEC_IMPORTE FROM SICOP_DETALLECONTROLPRESUPUESTAL
WHERE CPRE_INT_IDCONTROLPRESUPUESTAL=@CPRE_INT_IDCONTROLPRESUPUESTAL 
GO

-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_L_SICOP_CONTROLPRESUPUESTAL_REPORT
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_L_SICOP_CONTROLPRESUPUESTAL_REPORT', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_L_SICOP_CONTROLPRESUPUESTAL_REPORT
GO
CREATE PROCEDURE [dbo].[USP_L_SICOP_CONTROLPRESUPUESTAL_REPORT]
AS
/*
+	NOMBRE				: USP_L_SICOP_CONTROLPRESUPUESTAL_REPORT
+	DESCRIPCION			: REPORTE DE LOS CONTROLES PRESUPUESTALES 
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
SET NOCOUNT OFF;

CREATE TABLE #TABLE_TEMP (
CPRE_INT_IDCONTROLPRESUPUESTAL INT,
DOCU_VCH_NOMBRE VARCHAR(100),
CPRE_VCH_NRODOCUMENTO VARCHAR(10),
CPRE_DAT_FECHAINGRESO DATETIME,
CPRE_VCH_NROCOMPROBANTEPAGO VARCHAR(10), 
CPRE_VCH_NROSIAF VARCHAR(10), 
CPRE_DAT_FECHAGIRO DATETIME, 
CPRE_DAT_FECHAPAGO DATETIME,
CPRE_VCH_DETALLEESPECIFICADEGASTO VARCHAR(200),
CPRE_VCH_CONCEPTOESPECIFICADEGASTO VARCHAR(200),
EGAS_VCH_IDESPECIFICADEGASTO VARCHAR(13),
CPRE_VCH_PARTIDACONTABLE VARCHAR(20),
META_DEC_META_34 DECIMAL(10,3),
META_DEC_META_62 DECIMAL(10,3),
META_DEC_META_63 DECIMAL(10,3),
META_DEC_TOTAL DECIMAL(10,3)
);
INSERT INTO #TABLE_TEMP(
CPRE_INT_IDCONTROLPRESUPUESTAL ,
DOCU_VCH_NOMBRE ,
CPRE_VCH_NRODOCUMENTO ,
CPRE_DAT_FECHAINGRESO ,
CPRE_VCH_NROCOMPROBANTEPAGO , 
CPRE_VCH_NROSIAF , 
CPRE_DAT_FECHAGIRO , 
CPRE_DAT_FECHAPAGO ,
CPRE_VCH_DETALLEESPECIFICADEGASTO,
CPRE_VCH_CONCEPTOESPECIFICADEGASTO ,
EGAS_VCH_IDESPECIFICADEGASTO ,
CPRE_VCH_PARTIDACONTABLE,
META_DEC_META_34 ,
META_DEC_META_62  ,
META_DEC_META_63 ,
META_DEC_TOTAL
)
SELECT 
CP.CPRE_INT_IDCONTROLPRESUPUESTAL ,
DOC.DOCU_VCH_NOMBRE ,
CP.CPRE_VCH_NRODOCUMENTO ,
CP.CPRE_DAT_FECHAINGRESO ,
CP.CPRE_VCH_NROCOMPROBANTEPAGO, 
CP.CPRE_VCH_NROSIAF, 
CP.CPRE_DAT_FECHAGIRO , 
CP.CPRE_DAT_FECHAPAGO ,
CP.CPRE_VCH_DETALLEESPECIFICADEGASTO ,
CP.CPRE_VCH_CONCEPTOESPECIFICADEGASTO ,
EGA.EGAS_VCH_IDESPECIFICADEGASTO ,
CPRE_VCH_PARTIDACONTABLE ,
 (SELECT DCPR_DEC_IMPORTE   
		FROM SICOP_DETALLECONTROLPRESUPUESTAL 
		WHERE EGAS_VCH_IDESPECIFICADEGASTO=EGA.EGAS_VCH_IDESPECIFICADEGASTO  AND
			CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL  AND
			META_VCH_IDMETA='0034'),
(SELECT DCPR_DEC_IMPORTE   
		FROM SICOP_DETALLECONTROLPRESUPUESTAL 
		WHERE EGAS_VCH_IDESPECIFICADEGASTO=EGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL  AND
			META_VCH_IDMETA='0062'),
(SELECT DCPR_DEC_IMPORTE   
		FROM SICOP_DETALLECONTROLPRESUPUESTAL 
		WHERE EGAS_VCH_IDESPECIFICADEGASTO=EGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL  AND
			META_VCH_IDMETA='0063'),

((SELECT DCPR_DEC_IMPORTE   
		FROM SICOP_DETALLECONTROLPRESUPUESTAL 
		WHERE EGAS_VCH_IDESPECIFICADEGASTO=EGA.EGAS_VCH_IDESPECIFICADEGASTO  AND
			CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL  AND
			META_VCH_IDMETA='0034') +
(SELECT DCPR_DEC_IMPORTE   
		FROM SICOP_DETALLECONTROLPRESUPUESTAL 
		WHERE EGAS_VCH_IDESPECIFICADEGASTO=EGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL  AND
			META_VCH_IDMETA='0062') +
(SELECT DCPR_DEC_IMPORTE   
		FROM SICOP_DETALLECONTROLPRESUPUESTAL 
		WHERE EGAS_VCH_IDESPECIFICADEGASTO=EGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL  AND
			META_VCH_IDMETA='0063'))

 	FROM dbo.SICOP_CONTROLPRESUPUESTAL CP,
		 dbo.SICOP_DOCUMENTO DOC,
		 dbo.SICOP_ESPECIFICADEGASTO EGA
		 WHERE  CP.EGAS_VCH_IDESPECIFICADEGASTO =EGA.EGAS_VCH_IDESPECIFICADEGASTO AND
		 		CP.DOCU_INT_IDDOCUMENTO =DOC.DOCU_INT_IDDOCUMENTO ;
		 		
SELECT * FROM #TABLE_TEMP;
DROP TABLE #TABLE_TEMP;
GO


-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_L_SICOP_META_ESPECIFICADEGASTO_REPORT
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_L_SICOP_META_ESPECIFICADEGASTO_REPORT', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_L_SICOP_META_ESPECIFICADEGASTO_REPORT
GO
CREATE PROCEDURE [dbo].[USP_L_SICOP_META_ESPECIFICADEGASTO_REPORT]
	@_META_VCH_IDMETA VARCHAR(4),
	@_MEGA_VCH_ANIO VARCHAR(4)
AS
/*
+	NOMBRE				: USP_L_SICOP_META_ESPECIFICADEGASTO_REPORT
+	DESCRIPCION			: REPORTE DE METAS CON ESPECIFICAS DE GASTO SEGÚN LA ID DE LA META 
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
SET NOCOUNT OFF;
CREATE TABLE #TABLE_TEMP_E (
META_VCH_IDMETA VARCHAR(4),
EGAS_VCH_IDESPECIFICADEGASTO VARCHAR(13),
MEGA_VCH_ANIO VARCHAR(4),
MEGA_DEC_PIM DECIMAL(10,3),
MEGA_MODIFICACION DECIMAL(10,3),
MEGA_PRESUPUESTO DECIMAL(10,3),
ENERO DECIMAL(10,3),
FEBRERO DECIMAL(10,3),
MARZO DECIMAL(10,3),
ABRIL DECIMAL(10,3),
MAYO DECIMAL(10,3),
JUNIO DECIMAL(10,3),
JULIO DECIMAL(10,3),
AGOSTO DECIMAL(10,3),
SETIEMBRE DECIMAL(10,3),
OCTUBRE DECIMAL(10,3),
NOVIEMBRE DECIMAL(10,3),
DICIEMBRE DECIMAL(10,3),
TOTALEJECUTADO DECIMAL(10,3),
SALDO DECIMAL(10,3));

INSERT INTO #TABLE_TEMP_E(
META_VCH_IDMETA ,
EGAS_VCH_IDESPECIFICADEGASTO ,
MEGA_VCH_ANIO,
MEGA_DEC_PIM ,
MEGA_MODIFICACION ,
MEGA_PRESUPUESTO ,
ENERO ,
FEBRERO ,
MARZO ,
ABRIL ,
MAYO ,
JUNIO ,
JULIO ,
AGOSTO ,
SETIEMBRE ,
OCTUBRE ,
NOVIEMBRE ,
DICIEMBRE ,
TOTALEJECUTADO ,
SALDO )
SELECT META_VCH_IDMETA ,
EGAS_VCH_IDESPECIFICADEGASTO ,
MEGA_VCH_ANIO,
MEGA_DEC_PIM ,
 ISNULL((SELECT  SUM( MET.MEGM_DEC_PIMMODIFICADO)AS MEGA_MODIFICACION
  	    	   	FROM SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES MET 
			   WHERE MET.META_VCH_IDMETA=MEGA.META_VCH_IDMETA AND
			         MET.EGAS_VCH_IDESPECIFICADEGASTO=MEGA.EGAS_VCH_IDESPECIFICADEGASTO 
			            GROUP BY MET.META_VCH_IDMETA,MET.EGAS_VCH_IDESPECIFICADEGASTO),0),
0,
ISNULL(
(SELECT  SUM( DCP.DCPR_DEC_IMPORTE)AS DCPR_DEC_IMPORTE
	  	    	   	FROM SICOP_CONTROLPRESUPUESTAL CP,
			   SICOP_DETALLECONTROLPRESUPUESTAL DCP
			   WHERE DCP.CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=CP.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=MEGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.META_VCH_IDMETA=MEGA.META_VCH_IDMETA AND
					MONTH(CP.CPRE_DAT_FECHAINGRESO)=1 				
			         GROUP BY MONTH(CP.CPRE_DAT_FECHAINGRESO)),0) ,--ENE

ISNULL((SELECT  SUM( DCP.DCPR_DEC_IMPORTE)AS DCPR_DEC_IMPORTE
	  	    	   	FROM SICOP_CONTROLPRESUPUESTAL CP,
			   SICOP_DETALLECONTROLPRESUPUESTAL DCP
			   WHERE DCP.CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=CP.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=MEGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.META_VCH_IDMETA=MEGA.META_VCH_IDMETA AND
					MONTH(CP.CPRE_DAT_FECHAINGRESO)=2 				
			         GROUP BY MONTH(CP.CPRE_DAT_FECHAINGRESO)),0) ,--FEB
ISNULL((SELECT  SUM( DCP.DCPR_DEC_IMPORTE)AS DCPR_DEC_IMPORTE
	  	    	   	FROM SICOP_CONTROLPRESUPUESTAL CP,
			   SICOP_DETALLECONTROLPRESUPUESTAL DCP
			   WHERE DCP.CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=CP.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=MEGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.META_VCH_IDMETA=MEGA.META_VCH_IDMETA AND
					MONTH(CP.CPRE_DAT_FECHAINGRESO)=3 				
			         GROUP BY MONTH(CP.CPRE_DAT_FECHAINGRESO)),0) ,--MAR
ISNULL((SELECT  SUM( DCP.DCPR_DEC_IMPORTE)AS DCPR_DEC_IMPORTE
	  	    	   	FROM SICOP_CONTROLPRESUPUESTAL CP,
			   SICOP_DETALLECONTROLPRESUPUESTAL DCP
			   WHERE DCP.CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=CP.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=MEGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.META_VCH_IDMETA=MEGA.META_VCH_IDMETA AND
					MONTH(CP.CPRE_DAT_FECHAINGRESO)=4 	--ABRIL				
			         GROUP BY MONTH(CP.CPRE_DAT_FECHAINGRESO)),0) ,
ISNULL((SELECT  SUM( DCP.DCPR_DEC_IMPORTE)AS DCPR_DEC_IMPORTE
	  	    	   	FROM SICOP_CONTROLPRESUPUESTAL CP,
			   SICOP_DETALLECONTROLPRESUPUESTAL DCP
			   WHERE DCP.CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=CP.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=MEGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.META_VCH_IDMETA=MEGA.META_VCH_IDMETA AND
					MONTH(CP.CPRE_DAT_FECHAINGRESO)=5				
			         GROUP BY MONTH(CP.CPRE_DAT_FECHAINGRESO)),0) ,--MAY
ISNULL((SELECT  SUM( DCP.DCPR_DEC_IMPORTE)AS DCPR_DEC_IMPORTE
	  	    	   	FROM SICOP_CONTROLPRESUPUESTAL CP,
			   SICOP_DETALLECONTROLPRESUPUESTAL DCP
			   WHERE DCP.CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=CP.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=MEGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.META_VCH_IDMETA=MEGA.META_VCH_IDMETA AND
					MONTH(CP.CPRE_DAT_FECHAINGRESO)=6 				
			         GROUP BY MONTH(CP.CPRE_DAT_FECHAINGRESO)),0) ,--JUN
ISNULL((SELECT  SUM( DCP.DCPR_DEC_IMPORTE)AS DCPR_DEC_IMPORTE
	  	    	   	FROM SICOP_CONTROLPRESUPUESTAL CP,
			   SICOP_DETALLECONTROLPRESUPUESTAL DCP
			   WHERE DCP.CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=CP.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=MEGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.META_VCH_IDMETA=MEGA.META_VCH_IDMETA AND
					MONTH(CP.CPRE_DAT_FECHAINGRESO)=7 				
			         GROUP BY MONTH(CP.CPRE_DAT_FECHAINGRESO)),0) ,--JUL
ISNULL((SELECT  SUM( DCP.DCPR_DEC_IMPORTE)AS DCPR_DEC_IMPORTE
	  	    	   	FROM SICOP_CONTROLPRESUPUESTAL CP,
			   SICOP_DETALLECONTROLPRESUPUESTAL DCP
			   WHERE DCP.CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=CP.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=MEGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.META_VCH_IDMETA=MEGA.META_VCH_IDMETA AND
					MONTH(CP.CPRE_DAT_FECHAINGRESO)=8 				
			         GROUP BY MONTH(CP.CPRE_DAT_FECHAINGRESO)),0) ,--AGO
ISNULL((SELECT  SUM( DCP.DCPR_DEC_IMPORTE)AS DCPR_DEC_IMPORTE
	  	    	   	FROM SICOP_CONTROLPRESUPUESTAL CP,
			   SICOP_DETALLECONTROLPRESUPUESTAL DCP
			   WHERE DCP.CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=CP.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=MEGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.META_VCH_IDMETA=MEGA.META_VCH_IDMETA AND
					MONTH(CP.CPRE_DAT_FECHAINGRESO)=9 				
			         GROUP BY MONTH(CP.CPRE_DAT_FECHAINGRESO)),0) ,--SET
ISNULL((SELECT  SUM( DCP.DCPR_DEC_IMPORTE)AS DCPR_DEC_IMPORTE
	  	    	   	FROM SICOP_CONTROLPRESUPUESTAL CP,
			   SICOP_DETALLECONTROLPRESUPUESTAL DCP
			   WHERE DCP.CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=CP.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=MEGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.META_VCH_IDMETA=MEGA.META_VCH_IDMETA AND
					MONTH(CP.CPRE_DAT_FECHAINGRESO)=10 				
			         GROUP BY MONTH(CP.CPRE_DAT_FECHAINGRESO)),0) ,--OCT
ISNULL((SELECT  SUM( DCP.DCPR_DEC_IMPORTE)AS DCPR_DEC_IMPORTE
	  	    	   	FROM SICOP_CONTROLPRESUPUESTAL CP,
			   SICOP_DETALLECONTROLPRESUPUESTAL DCP
			   WHERE DCP.CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=CP.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=MEGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.META_VCH_IDMETA=MEGA.META_VCH_IDMETA AND
					MONTH(CP.CPRE_DAT_FECHAINGRESO)=11 				
			         GROUP BY MONTH(CP.CPRE_DAT_FECHAINGRESO)),0) ,--NOV
ISNULL((SELECT  SUM( DCP.DCPR_DEC_IMPORTE)AS DCPR_DEC_IMPORTE
	  	    	   	FROM SICOP_CONTROLPRESUPUESTAL CP,
			   SICOP_DETALLECONTROLPRESUPUESTAL DCP
			   WHERE DCP.CPRE_INT_IDCONTROLPRESUPUESTAL=CP.CPRE_INT_IDCONTROLPRESUPUESTAL AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=CP.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.EGAS_VCH_IDESPECIFICADEGASTO=MEGA.EGAS_VCH_IDESPECIFICADEGASTO AND
			         DCP.META_VCH_IDMETA=MEGA.META_VCH_IDMETA AND
					MONTH(CP.CPRE_DAT_FECHAINGRESO)=12 				
			         GROUP BY MONTH(CP.CPRE_DAT_FECHAINGRESO)),0) ,--DIC
0,--EJE
0--SALDO
FROM SICOP_META_ESPECIFICADEGASTO MEGA
	WHERE MEGA.META_VCH_IDMETA=@_META_VCH_IDMETA 
	
--UPDATE TOTALEJECUTADO
  	UPDATE #TABLE_TEMP_E SET
 		TOTALEJECUTADO = ENERO +FEBRERO +MARZO +ABRIL +MAYO +JUNIO +JULIO +AGOSTO +SETIEMBRE +OCTUBRE +NOVIEMBRE +DICIEMBRE
 	FROM #TABLE_TEMP_E 
 	
 --UPDATE PRESUPUESTO
  	UPDATE #TABLE_TEMP_E SET
  	MEGA_PRESUPUESTO=(MEGA_DEC_PIM+MEGA_MODIFICACION)
  	
--UPDATE SALDOEJERCICIO
 	UPDATE #TABLE_TEMP_E SET
 		SALDO=(MEGA_PRESUPUESTO-TOTALEJECUTADO)
 	FROM #TABLE_TEMP_E 
 	
SELECT * FROM #TABLE_TEMP_E;
DROP TABLE #TABLE_TEMP_E;

-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_I_SICOP_ESPECIFICADEGASTO
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_I_SICOP_ESPECIFICADEGASTO', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_I_SICOP_ESPECIFICADEGASTO
GO
CREATE PROCEDURE [dbo].[USP_I_SICOP_ESPECIFICADEGASTO]
(
	@EGAS_VCH_IDESPECIFICADEGASTO varchar(13),
	@EGAS_VCH_DESCRIPCION varchar(200)
)
AS
/*
+	NOMBRE				: USP_I_SICOP_ESPECIFICADEGASTO
+	DESCRIPCION			: INSERTAR UNA NUEVA ESPECIFICA DE GASTO
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
INSERT INTO SICOP_ESPECIFICADEGASTO(EGAS_VCH_IDESPECIFICADEGASTO, EGAS_VCH_DESCRIPCION) 
VALUES(@EGAS_VCH_IDESPECIFICADEGASTO,@EGAS_VCH_DESCRIPCION)
GO

-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_U_SICOP_ESPECIFICADEGASTO
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_U_SICOP_ESPECIFICADEGASTO', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_U_SICOP_ESPECIFICADEGASTO
GO
CREATE PROCEDURE [dbo].[USP_U_SICOP_ESPECIFICADEGASTO]
(
	@EGAS_VCH_IDESPECIFICADEGASTO varchar(13),
	@EGAS_VCH_DESCRIPCION varchar(200)
)
AS
/*
+	NOMBRE				: USP_U_SICOP_ESPECIFICADEGASTO
+	DESCRIPCION			: MODIFICAR UNA DETERMINADA ESPECIFICA DE GASTO
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
UPDATE SICOP_ESPECIFICADEGASTO 
SET 
	EGAS_VCH_IDESPECIFICADEGASTO = @EGAS_VCH_IDESPECIFICADEGASTO,
	EGAS_VCH_DESCRIPCION = @EGAS_VCH_DESCRIPCION
WHERE SICOP_ESPECIFICADEGASTO.EGAS_VCH_IDESPECIFICADEGASTO = @EGAS_VCH_IDESPECIFICADEGASTO
GO

-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_D_SICOP_ESPECIFICADEGASTO
--/////////////////////////////////////////////////////////
IF OBJECT_ID ( 'USP_D_SICOP_ESPECIFICADEGASTO', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_D_SICOP_ESPECIFICADEGASTO
GO
CREATE PROCEDURE [dbo].[USP_D_SICOP_ESPECIFICADEGASTO]
(
 @EGAS_VCH_IDESPECIFICADEGASTO varchar(13)
)
AS
/*
+	NOMBRE				: USP_D_SICOP_ESPECIFICADEGASTO
+	DESCRIPCION			: ELIMINAR UNA DETERMINADA ESPECIFICA DE GASTO
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
DELETE FROM SICOP_ESPECIFICADEGASTO
WHERE EGAS_VCH_IDESPECIFICADEGASTO = @EGAS_VCH_IDESPECIFICADEGASTO
GO

-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_L_SICOP_ESPECIFICADEGASTO
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_L_SICOP_ESPECIFICADEGASTO', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_L_SICOP_ESPECIFICADEGASTO
GO
CREATE PROCEDURE [dbo].[USP_L_SICOP_ESPECIFICADEGASTO]
AS
/*
+	NOMBRE				: USP_L_SICOP_ESPECIFICADEGASTO
+	DESCRIPCION			: LISTA TODAS LAS ESPECIFICAS DE GASTO
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
SELECT * FROM SICOP_ESPECIFICADEGASTO
GO

-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_L_SICOP_META
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_L_SICOP_META', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_L_SICOP_META
GO
CREATE PROCEDURE [dbo].[USP_L_SICOP_META]
AS
/*
+	NOMBRE				: USP_L_SICOP_META
+	DESCRIPCION			: LISTA TODAS LAS METAS
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
SELECT * FROM SICOP_META
GO

-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_L_SICOP_DOCUMENTO
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_L_SICOP_DOCUMENTO', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_L_SICOP_DOCUMENTO
GO
CREATE PROCEDURE [dbo].[USP_L_SICOP_DOCUMENTO]
AS
/*
+	NOMBRE				: USP_L_SICOP_DOCUMENTO
+	DESCRIPCION			: LISTA TODOS LOS DOCUMENTOS
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
SELECT * FROM SICOP_DOCUMENTO
GO

-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_I_SICOP_META_ESPECIFICADEGASTO
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_I_SICOP_META_ESPECIFICADEGASTO', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_I_SICOP_META_ESPECIFICADEGASTO
GO
CREATE PROCEDURE [dbo].[USP_I_SICOP_META_ESPECIFICADEGASTO]
(
	@META_VCH_IDMETA varchar(4),
	@EGAS_VCH_IDESPECIFICADEGASTO varchar(13),
	@MEGA_VCH_ANIO varchar(4),
	@MEGA_DEC_PIM decimal(10,3)
)
AS
/*
+	NOMBRE				: USP_I_SICOP_META_ESPECIFICADEGASTO
+	DESCRIPCION			: INSERTAR UN NUEVO PIM A DETERMINADA META SEGÚN LA ESPECIFICA DE GASTO Y EL AÑO
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
INSERT INTO SICOP_META_ESPECIFICADEGASTO(META_VCH_IDMETA, EGAS_VCH_IDESPECIFICADEGASTO, MEGA_VCH_ANIO,MEGA_DEC_PIM) 
VALUES(@META_VCH_IDMETA,@EGAS_VCH_IDESPECIFICADEGASTO, @MEGA_VCH_ANIO,@MEGA_DEC_PIM)
GO
-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_I_SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_I_SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_I_SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES
GO
CREATE PROCEDURE [dbo].[USP_I_SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES]
(
	@META_VCH_IDMETA varchar(4),
	@EGAS_VCH_IDESPECIFICADEGASTO varchar(13),
	@MEGM_DEC_PIMMODIFICADO decimal(10,3)
)
AS
/*
+	NOMBRE				: USP_I_SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES
+	DESCRIPCION			: INSERTAR UNA NUEVA MODIFICACIÓN AL PIM ANTES INGRESADO A DETERMINADA META SEGÚN LA ESPECIFICA DE GASTO Y EL AÑO
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
INSERT INTO SICOP_META_ESPECIFICADEGASTO_MODIFICACIONES
(META_VCH_IDMETA, EGAS_VCH_IDESPECIFICADEGASTO, MEGM_DEC_PIMMODIFICADO) 
VALUES(@META_VCH_IDMETA,@EGAS_VCH_IDESPECIFICADEGASTO, @MEGM_DEC_PIMMODIFICADO)
GO

-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_I_SICOP_CONTROLPRESUPUESTAL
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_I_SICOP_CONTROLPRESUPUESTAL', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_I_SICOP_CONTROLPRESUPUESTAL
GO
CREATE PROCEDURE [dbo].[USP_I_SICOP_CONTROLPRESUPUESTAL]
(   @CPRE_INT_IDCONTROLPRESUPUESTAL INT OUT,
	@EGAS_VCH_IDESPECIFICADEGASTO VARCHAR(13),
	@DOCU_INT_IDDOCUMENTO VARCHAR(13),
	@CPRE_VCH_NRODOCUMENTO VARCHAR(10),
	@CPRE_DAT_FECHAINGRESO DATETIME,
	@CPRE_VCH_NROCOMPROBANTEPAGO VARCHAR(10),
	@CPRE_VCH_NROSIAF VARCHAR(10),
	@CPRE_DAT_FECHAGIRO DATETIME,
	@CPRE_DAT_FECHAPAGO DATETIME,
	@CPRE_VCH_CONCEPTOESPECIFICADEGASTO VARCHAR(200),
	@CPRE_VCH_DETALLEESPECIFICADEGASTO VARCHAR(200),
	@CPRE_VCH_PARTIDACONTABLE VARCHAR(20)
)
AS
/*
+	NOMBRE				: USP_I_SICOP_CONTROLPRESUPUESTAL
+	DESCRIPCION			: INSERTAR UN NUEVO CONTROL PRESUPUESTAL 
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
BEGIN
SET NOCOUNT OFF;
INSERT INTO SICOP_CONTROLPRESUPUESTAL
(EGAS_VCH_IDESPECIFICADEGASTO, DOCU_INT_IDDOCUMENTO, CPRE_VCH_NRODOCUMENTO, CPRE_DAT_FECHAINGRESO,
CPRE_VCH_NROCOMPROBANTEPAGO,CPRE_VCH_NROSIAF,CPRE_DAT_FECHAGIRO,CPRE_DAT_FECHAPAGO,CPRE_VCH_CONCEPTOESPECIFICADEGASTO,
CPRE_VCH_DETALLEESPECIFICADEGASTO,CPRE_VCH_PARTIDACONTABLE) 
VALUES(@EGAS_VCH_IDESPECIFICADEGASTO,@DOCU_INT_IDDOCUMENTO, @CPRE_VCH_NRODOCUMENTO, @CPRE_DAT_FECHAINGRESO,
@CPRE_VCH_NROCOMPROBANTEPAGO,@CPRE_VCH_NROSIAF,@CPRE_DAT_FECHAGIRO,@CPRE_DAT_FECHAPAGO,@CPRE_VCH_CONCEPTOESPECIFICADEGASTO,
@CPRE_VCH_DETALLEESPECIFICADEGASTO,@CPRE_VCH_PARTIDACONTABLE)
SELECT @CPRE_INT_IDCONTROLPRESUPUESTAL =SCOPE_IDENTITY();
END;

GO

-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_U_SICOP_CONTROLPRESUPUESTAL
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_U_SICOP_CONTROLPRESUPUESTAL', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_U_SICOP_CONTROLPRESUPUESTAL
GO
CREATE PROCEDURE [dbo].[USP_U_SICOP_CONTROLPRESUPUESTAL]
(
	@CPRE_INT_IDCONTROLPRESUPUESTAL INT,
	@EGAS_VCH_IDESPECIFICADEGASTO VARCHAR(13),
	@DOCU_INT_IDDOCUMENTO VARCHAR(13),
	@CPRE_VCH_NRODOCUMENTO VARCHAR(10),
	@CPRE_DAT_FECHAINGRESO DATETIME,
	@CPRE_VCH_NROCOMPROBANTEPAGO VARCHAR(10),
	@CPRE_VCH_NROSIAF VARCHAR(10),
	@CPRE_DAT_FECHAGIRO DATETIME,
	@CPRE_DAT_FECHAPAGO DATETIME,
	@CPRE_VCH_CONCEPTOESPECIFICADEGASTO VARCHAR(200),
	@CPRE_VCH_DETALLEESPECIFICADEGASTO VARCHAR(200),
	@CPRE_VCH_PARTIDACONTABLE VARCHAR(20)
)
AS
/*
+	NOMBRE				: USP_U_SICOP_CONTROLPRESUPUESTAL
+	DESCRIPCION			: MODIFICAR UN DETERMINADO CONTROL PRESUPUESTAL 
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
UPDATE SICOP_CONTROLPRESUPUESTAL 
SET 
	EGAS_VCH_IDESPECIFICADEGASTO = @EGAS_VCH_IDESPECIFICADEGASTO,
	DOCU_INT_IDDOCUMENTO = @DOCU_INT_IDDOCUMENTO,
	CPRE_VCH_NRODOCUMENTO = @CPRE_VCH_NRODOCUMENTO,
	CPRE_DAT_FECHAINGRESO = @CPRE_DAT_FECHAINGRESO,
	CPRE_VCH_NROCOMPROBANTEPAGO = @CPRE_VCH_NROCOMPROBANTEPAGO,
	CPRE_VCH_NROSIAF = @CPRE_VCH_NROSIAF,
	CPRE_DAT_FECHAGIRO = @CPRE_DAT_FECHAGIRO,
	CPRE_DAT_FECHAPAGO = @CPRE_DAT_FECHAPAGO,
	CPRE_VCH_CONCEPTOESPECIFICADEGASTO = @CPRE_VCH_CONCEPTOESPECIFICADEGASTO,
	CPRE_VCH_DETALLEESPECIFICADEGASTO = @CPRE_VCH_DETALLEESPECIFICADEGASTO,
	CPRE_VCH_PARTIDACONTABLE = @CPRE_VCH_PARTIDACONTABLE
WHERE SICOP_CONTROLPRESUPUESTAL .CPRE_INT_IDCONTROLPRESUPUESTAL = @CPRE_INT_IDCONTROLPRESUPUESTAL
GO
-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_I_SICOP_DETALLECONTROLPRESUPUESTAL
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_I_SICOP_DETALLECONTROLPRESUPUESTAL', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_I_SICOP_DETALLECONTROLPRESUPUESTAL
GO
CREATE PROCEDURE [dbo].[USP_I_SICOP_DETALLECONTROLPRESUPUESTAL]
(
	@CPRE_INT_IDCONTROLPRESUPUESTAL INT,
	@EGAS_VCH_IDESPECIFICADEGASTO VARCHAR(13),
	@META_VCH_IDMETA VARCHAR(4),
	@DCPR_DEC_IMPORTE DECIMAL(10,3)
)
AS
/*
+	NOMBRE				: USP_I_SICOP_DETALLECONTROLPRESUPUESTAL
+	DESCRIPCION			: INSERTAR UN DETERMINADO CONTROL PRESUPUESTAL 
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
INSERT INTO SICOP_DETALLECONTROLPRESUPUESTAL
(CPRE_INT_IDCONTROLPRESUPUESTAL,EGAS_VCH_IDESPECIFICADEGASTO, META_VCH_IDMETA, DCPR_DEC_IMPORTE) 
VALUES(@CPRE_INT_IDCONTROLPRESUPUESTAL,@EGAS_VCH_IDESPECIFICADEGASTO,@META_VCH_IDMETA, @DCPR_DEC_IMPORTE)
GO

-----------------------------------------------------------------------------------------------

--/////////////////////////////////////////////////////////
--USP_LOG_SICOP_USUARIO
--/////////////////////////////////////////////////////////

IF OBJECT_ID ( 'USP_LOG_SICOP_USUARIO', 'P' ) IS NOT NULL 
    DROP PROCEDURE USP_LOG_SICOP_USUARIO
GO
CREATE PROCEDURE [dbo].[USP_LOG_SICOP_USUARIO]
@usu varchar(50),
@password varchar(50)
AS
/*
+	NOMBRE				: USP_LOG_SICOP_USUARIO
+	DESCRIPCION			: LOGIN DE USUARIO 
+	FECHA				: 13-09-2015
+	AUTOR				: EDÚ VERA ALVAREZ
+	ARGUMENTOS			:
+	FEC. MODIFIC		: 
+	AUTOR MODIFIC		: 
+	CAMBIOS IMPORTANTE	: 
*/
SELECT * FROM 
SICOP_USUARIO 
WHERE SICOP_USUARIO.USU_VCH_USUARIO = @usu 
and SICOP_USUARIO.USU_VCH_PASSWORD = @password 
GO
